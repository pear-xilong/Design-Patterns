<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>11-观察者模式</title>
  </head>
  <body>
    <script>
      /* 
      观察者模式: 定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象，当主题对象发生变化时，它的所有依赖者（观察者）都会收到通知并更新。
    */

      // 被观察者
      class Sub {
        constructor() {
          this.observer = [] // 存储观察者
        }
        add(observer) {
          this.observer.push(observer)
        }
        remove(observer) {
          this.observer = this.observer.filter(t => t !== observer)
        }
        trigger() {
          this.observer.forEach(t => t.updated())
        }
      }

      // 观察者
      class Observer {
        constructor(name) {
          this.name = name
        }
        updated() {
          console.log('updated', this.name)
        }
      }

      const sub = new Sub()
      const observer1 = new Observer('zhangsan')
      const observer2 = new Observer('lisi')
      sub.add(observer1)
      sub.add(observer2)
      console.log(sub)
      /* setTimeout(() => {
        sub.remove(observer1)
        console.log(sub)
      }, 1000) */
    </script>
  </body>
</html>
